<project name="dataloader_newuid_migrate" default="dist" basedir=".">
    <description>
        XingyunAnalytics component in XingCloud project
    </description>
    <!-- set dataloader properties for this build -->
    <property name="dataloadersrc" value="src/main/java/com/xingcloud/dataloader" />
	<property name="src" value="src/main/java" />
    <property name="build" value="build" />
    <property name="dist" value="dist" />
    <property name="conf" value="conf" />
    <property name="lib" value="lib" />
    <property name="jar_name" value="dataloader_etl.jar" />

   
    <path id="buildlibs">
        <pathelement location="${conf}" />
        <fileset dir="${lib}">
            <include name="**/*.jar" />
        </fileset>
    </path>
	
	<target name="clean" description="clean up">
        <!-- Delete the ${build} and ${dist} directory trees -->
        <mkdir dir="${dist}" />
        <delete dir="${build}" />
        <delete file="${dist}/${jar_name}" />
    </target>
	
    <target name="init" depends="clean">
        <!-- Create the build directory structure used by compile -->
        <mkdir dir="${build}" />
    </target>

    <target name="compile" depends="init" description="compile the source ">
        <copy todir="${build}">
		  <fileset dir="${src}">
			<exclude name="**/*.java" />
			<exclude name="**/*.class" />
			<exclude name="**/*.html" />
			<exclude name="**/log4j.properties" />
		  </fileset>
		</copy>
        <!-- Compile the java code from ${src} into ${build} -->
        <javac destdir="${build}" encoding="utf-8" debug="on">
			<src path="${src}"/>
            <classpath refid="buildlibs" />
        </javac>
    </target>
	<target name="unzipjar" depends="compile">
        <unzip dest="${build}">
            <fileset dir="${lib}"> 
                <include name="*/*/*.jar" />
                <include name="*/*.jar" />
                <include name="*.jar" />
            </fileset>
        </unzip>
    </target>
    
    <target name="dist" depends="unzipjar" description="generate the distribution jar">

        <!-- Put everything in ${build} into the DataProxy-${DSTAMP}.jar file -->
        <jar jarfile="${dist}/${jar_name}" basedir="${build}">
            <fileset dir="${conf}" />

            <manifest>
                <!--attribute name="Main-Class" value="com.xingcloud.xcdb.MainRun"/-->
            </manifest>
        </jar>
    </target>

    

</project>
